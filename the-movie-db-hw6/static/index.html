<!DOCTYPE html>
<html>
    <head>
        <title> </title>

        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@600&display=swap" rel="stylesheet">

        <style>
            body{
                background-color: black;
            }
            #heading {
                height: 40px;
                background-image: linear-gradient(to right, rgba(167,0,18,0) 70%, rgba(167,0,18,1));
            }
            #logo {
                color : #A70012;
                font-family: 'Open Sans', sans-serif;
            }
            .flex-container {
                display: flex;
                align-items: stretch;
                margin-top: 10px;
            }
            .flex-container > div {
                color: white;
                margin: 10px;
                text-align: center;
                line-height: 75px;
                font-size: 30px;
            }
            .trending-movie {display: none;}
            .trending-tv-show {display: none;}
            .movie-carousel { position: relative;}
            .tv-show-carousel { position: relative;}
            .caption-text {
                color: white;
                font-size: 20px;
                position: absolute;
                bottom: 8px;
                width: 100%;
                text-align: center;
                background-color:rgba(0,0,0,0.5);
                height: 100px;
                font-family: 'Open Sans', sans-serif;
            }
            
            /* Fading Animation */
            .fade {
                -webkit-animation-name: fade;
                -webkit-animation-duration: 1.5s;
                animation-name: fade;
                animation-duration: 1.5s;
            }
            @-webkit-keyframes fade {
                from {opacity: .4} 
                to {opacity: 1}
            }
            @keyframes fade {
                from {opacity: .4} 
                to {opacity: 1}
            }

            .tab-button {
                color: #A70012;
                padding: 15px 32px;
                text-decoration: none;
                font-size: 16px;
                cursor: pointer;
            }
            #button-wrapper{
                border-right: 1px solid white;
            }

        </style>

        <script>

            function load_homepage()
            {
                base_url = "https://image.tmdb.org/t/p/w780/"

                var request = new XMLHttpRequest();
                request.open("GET", "/trending_movies", true);
                request.onreadystatechange = function() {
                    if (request.readyState == 4 && request.status == 200) 
                    {
                        movie_list = JSON.parse(this.responseText).top_movies;
                        var i = 1;
                        movie_list.forEach(movie => {
                            document.getElementById("trending-movie-"+i).src = base_url + movie.backdrop_path;
                            document.getElementById("trending-movie-caption-text-"+i).innerHTML = movie.title + " (" + new Date(Date.parse(movie.release_air_date)).getFullYear() +")";
                            i++;
                        });
                        
                    }
                };
                request.send(null);

                var request = new XMLHttpRequest();
                request.open("GET", "/tv_shows_airing_today", true);
                request.onreadystatechange = function() {
                    if (request.readyState == 4 && request.status == 200) 
                    {
                        movie_list = JSON.parse(this.responseText).top_tv_shows;
                        var i = 1;
                        movie_list.forEach(movie => {
                            document.getElementById("trending-tv-show-"+i).src = base_url + movie.backdrop_path;
                            document.getElementById("trending-tv-show-caption-text-"+i).innerHTML = movie.title + " (" + new Date(Date.parse(movie.release_air_date)).getFullYear() +")";
                            console.log(movie)
                            i++;
                        });
                        display_carousel();
                    }
                };
                request.send(null);
            }
        </script>
</head>
<body onload = "load_homepage()">
    <div id = "heading">
        <h1 id = "logo"> THE MOVIE DB </h1>
    </div>
    <div class = "flex-container">
        <div id = "button-wrapper" style = "flex-grow: 3">
            <div><a href="#" class = "tab-button">Home &#10230;</a></div>
            <div><a href="#" class = "tab-button">Search &#10230;</a></div>
        </div>
        <div style = "flex-grow: 8">
            <div class = "carousel-titles">Trending Movies</div>
            <div class ="movie-carousel">
                <div class = "trending-movie fade">
                    <img id = "trending-movie-1">
                    <div class = "caption-text" id = "trending-movie-caption-text-1"></div>
                </div>
                <div class = "trending-movie fade">
                    <img id = "trending-movie-2">
                    <div class = "caption-text" id = "trending-movie-caption-text-2"></div>
                </div>
                <div class = "trending-movie fade">
                    <img id = "trending-movie-3">
                    <div class = "caption-text" id = "trending-movie-caption-text-3"></div>
                </div>
                <div class = "trending-movie fade">
                    <img id = "trending-movie-4">
                    <div class = "caption-text" id = "trending-movie-caption-text-4"></div>
                </div>
                <div class = "trending-movie fade">
                    <img id = "trending-movie-5">
                    <div class = "caption-text" id = "trending-movie-caption-text-5"></div>
                </div>
            </div>
            <div class = "carousel-titles">TV Shows On-Air Today</div>
            <div class="tv-show-carousel">
                <div class = "trending-tv-show fade">
                    <img id = "trending-tv-show-1">
                    <div class = "caption-text" id = "trending-tv-show-caption-text-1"></div>
                </div>
                <div class = "trending-tv-show fade">
                    <img id = "trending-tv-show-2">
                    <div class = "caption-text" id = "trending-tv-show-caption-text-2"></div>
                </div>
                <div class = "trending-tv-show fade">
                    <img id = "trending-tv-show-3">
                    <div class = "caption-text" id = "trending-tv-show-caption-text-3"></div>
                </div>
                <div class = "trending-tv-show fade">
                    <img id = "trending-tv-show-4">
                    <div class = "caption-text" id = "trending-tv-show-caption-text-4"></div>
                </div>
                <div class = "trending-tv-show fade">
                    <img id = "trending-tv-show-5">
                    <div class = "caption-text" id = "trending-tv-show-caption-text-5"></div>
                </div>
            </div>
        </div>
    </div>



    <script>
        var slide_index = 0;
    
        function display_carousel() {
        var i;
        var movie_slides = document.getElementsByClassName("trending-movie");
        var tv_show_slides = document.getElementsByClassName("trending-tv-show");
        for (i = 0; i < movie_slides.length; i++) {
            movie_slides[i].style.display = "none";  
            tv_show_slides[i].style.display = "none";  
        }
        slide_index++;
        if (slide_index > movie_slides.length) {slide_index = 1}    
        
        movie_slides[slide_index-1].style.display = "block"; 
        tv_show_slides[slide_index-1].style.display = "block";  
        
        setTimeout(display_carousel, 5000);
        }
    </script>

</body>
</html> 

